<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Space Quiz â€” PWA</title>
<link rel="manifest" href="./manifest.webmanifest">
<meta name="theme-color" content="#0a0e22"/>

<style>
:root{
  --bg:#0a0e22;--hud:#0f1533;--frame:#49e6ff;--cyan:#37D6E8;
  --panel:#0b1126;--pill:#0E152B;--text:#fff;--muted:#a7b3cc;
  --accent:#37D6E8;--ok:#22c55e;--bad:#ef4444
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  display:flex;align-items:center;justify-content:center;padding:18px
}
.hud{width:1200px;max-width:100%}

/* ---- Screen ---- */
.screen{
  height:720px;
  background:radial-gradient(1600px 900px at 10% -10%,#0f214d 0%,#0a0e22 55%),
             radial-gradient(900px 700px at 120% 120%,#0d1a44 0%,#0a0e22 60%),
             var(--hud);
  border:2px solid var(--frame);
  border-radius:28px;
  box-shadow:0 20px 60px rgba(0,0,0,.55);
  padding:16px;
  display:grid;
  grid-template-rows:auto auto 1fr;
  gap:10px;
  position:relative;
  overflow:hidden;
}
.screen:before{
  content:"";position:absolute;inset:10px;border-radius:22px;
  border:2px solid rgba(73,230,255,.35);
  outline:1px solid rgba(73,230,255,.15);
  box-shadow:inset 0 0 30px rgba(73,230,255,.08),inset 0 0 2px rgba(73,230,255,.75);
  pointer-events:none
}

/* Mobile/tablet: allow scroll + stack layout */
@media (max-width:1024px){
  .screen{height:auto;min-height:100svh;overflow:auto}
  body{overflow:auto}
  .row{grid-template-columns:1fr}
  .hero{order:2}
}

/* Header + controls */
header{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}
.badge{font-size:12px;border:1px solid rgba(73,230,255,.35);padding:6px 10px;border-radius:999px;color:#a7b3cc}
.group{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.lifelines{display:flex;gap:12px}
.ll{background:linear-gradient(180deg,var(--cyan),#25c0d3);color:#042a31;border:none;border-radius:999px;padding:10px 18px;font-weight:900;letter-spacing:.3px;cursor:pointer}
.ll:disabled{opacity:.5;cursor:not-allowed}

/* Question pill with avatar + question + question art */
.qpill{
  display:grid;grid-template-columns:auto 1fr auto;align-items:center;
  gap:16px;padding:14px 18px;border-radius:24px;
  background:linear-gradient(180deg,rgba(55,214,232,.95),rgba(25,170,190,.92));
  border:2px solid #79f0ff;color:#042a31
}
.qthumb{width:168px;height:168px;border-radius:18px;display:grid;place-items:end;overflow:hidden}
.qthumb img{width:100%;height:100%;object-fit:contain;transition:opacity .28s ease;transform:translateY(8px)} /* sits flush to bottom */
.qthumb img.fade-out{opacity:0}
#qtext{font-weight:900;font-size:32px;letter-spacing:.3px;text-shadow:0 1px 0 rgba(255,255,255,.25)}
.qart{width:160px;height:120px;display:grid;place-items:center}
.qart > div{width:100%;height:100%}

/* Layout */
.row{display:grid;grid-template-columns:650px minmax(0,1fr);gap:24px;min-height:0}
.card{background:var(--panel);border-radius:22px;border:4px solid var(--accent);padding:18px;display:grid;grid-template-rows:1fr auto;gap:12px}

/* Answers list */
#answers{list-style:none;padding:8px;margin:0;display:grid;gap:14px;overflow:visible}
.answer{display:flex;align-items:center;gap:12px;background:var(--pill);border:2px solid rgba(55,214,232,.8);border-radius:20px;padding:18px 20px;cursor:pointer;transition:transform .07s ease,border-color .2s ease,box-shadow .2s ease}
.answer:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(55,214,232,.12)}
.dot{position:relative;width:30px;height:30px;border-radius:50%;border:3px solid var(--accent);box-shadow:inset 0 0 0 4px rgba(0,0,0,.35)}
.answer .label{font-weight:800}
.answer.selected .dot::after,.answer.correct .dot::after{content:"";position:absolute;inset:6px;border-radius:50%;background:var(--accent)}
.answer.correct{border-color:var(--ok)}.answer.incorrect{border-color:var(--bad)}

footer{display:flex;align-items:center;justify-content:flex-end;gap:10px}
#status{min-height:22px;color:var(--muted);margin-right:auto}
button{background:linear-gradient(180deg,#1fc7e8,#0ea5b7);color:#05222a;border:none;padding:12px 16px;border-radius:12px;font-weight:900;letter-spacing:.3px;cursor:pointer;box-shadow:0 6px 16px rgba(31,199,232,.35)}
button.secondary{background:transparent;color:var(--text);border:1px solid rgba(73,230,255,.35);box-shadow:none}
button:disabled{opacity:.6;cursor:not-allowed}

/* Right hero panel (answer imagery + text) */
.hero{background:transparent;display:grid;grid-template-rows:auto 1fr;gap:10px;align-items:start;justify-content:center;padding:0}
.hero .answerText{font-weight:900;text-align:center;margin-top:6px}
.hero .answerInfo{color:var(--muted);text-align:center;margin-bottom:8px}
.hero .canvas{display:flex;align-items:center;justify-content:center}
.hero svg{width:100%;max-width:880px;height:auto;display:block;opacity:0;transition:opacity .5s ease}
.hero svg.show{opacity:1}

/* Video overlay after win */
#winOverlay{
  position:fixed;inset:0;background:#000;display:none;place-items:center;z-index:99
}
#winOverlay video{width:100%;height:100%;object-fit:cover}
#closeWin{position:absolute;top:16px;right:16px;z-index:2}

/* tiny volume slider */
#vol{width:180px}
</style>
</head>
<body>
<div class="hud">
  <div class="screen">
    <header>
      <div class="group">
        <div class="badge">Question <span id="qnum">1</span>/<span id="qtotal">10</span></div>
        <div class="lifelines">
          <button class="ll" id="ll5050">50/50</button>
          <button class="ll" id="llHint">Hint</button>
          <button class="ll" id="llSkip">Skip</button>
        </div>
      </div>
      <div class="group">
        <label class="badge"><input type="checkbox" id="sfxToggle" checked/> ðŸ”Š SFX</label>
        <label class="badge"><input type="checkbox" id="musicToggle" checked/> ðŸŽµ Music</label>
        <label class="badge">Vol <input type="range" id="vol" min="0" max="1" step="0.01" value="0.6"/></label>
      </div>
    </header>

    <!-- Question pill: avatar (left), text (center), question imagery (right) -->
    <div class="qpill">
      <div class="qthumb"><img id="thumb" alt="Avatar"/></div>
      <div id="qtext">Loading questionâ€¦</div>
      <div class="qart"><div id="qart"></div></div>
    </div>

    <!-- Bottom layout: answers (left) + answer imagery/text (right) -->
    <div class="row">
      <div class="card">
        <ul id="answers"></ul>
        <footer>
          <div id="status">Select an answer to continue.</div>
          <button class="secondary" id="resetBtn">Restart</button>
          <button id="nextBtn" disabled>Next</button>
        </footer>
      </div>
      <div class="hero">
        <div class="answerText" id="answerTitle"></div>
        <div class="answerInfo" id="answerInfo"></div>
        <div class="canvas" id="hero"></div>
      </div>
    </div>
  </div>
</div>

<!-- Win video overlay -->
<div id="winOverlay">
  <button id="closeWin" class="ll">âœ•</button>
  <video id="winVid" src="./goodjob.mp4" playsinline></video>
</div>

<script>
/* ---- PWA: register service worker (relative paths so GitHub Pages works) ---- */
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js', { scope: './' });
  });
}

/* ---- Avatar assets ---- */
const AVATAR_FILES={
  neutral:'./neutral-expression.png',
  happy:'./happy-expression.png',
  encourage:'./encouraging-expression.png'
};
const PLACEHOLDER='data:image/svg+xml;utf8,'+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240"><circle cx="120" cy="120" r="110" fill="#19304f"/><circle cx="120" cy="120" r="100" fill="#264c7a"/></svg>');
function loadAvatar(path,cb){const i=new Image();i.onload=()=>cb(path);i.onerror=()=>cb(PLACEHOLDER);i.src=path}
const thumb=document.getElementById('thumb');
function setThumb(state){thumb.classList.add('fade-out');loadAvatar(AVATAR_FILES[state],src=>{thumb.src=src;thumb.classList.remove('fade-out')})}

/* ---- Music (autoplays if permitted) ---- */
const music=new Audio('./Uncharted Worlds.mp3');
music.loop=true; music.volume=0.6;
const musicToggle=document.getElementById('musicToggle');
const vol=document.getElementById('vol');
function applyMusicToggle(){
  try{
    if(musicToggle.checked){ music.volume=+vol.value; music.play().catch(()=>{}); }
    else{ music.pause(); }
    localStorage.setItem('musicOn', musicToggle.checked?'1':'0');
    localStorage.setItem('musicVol', vol.value);
  }catch(e){}
}
musicToggle.addEventListener('change',applyMusicToggle);
vol.addEventListener('input',()=>{ music.volume=+vol.value; applyMusicToggle(); });
/* restore last choice */
(function(){
  if(localStorage.getItem('musicOn')==='0') musicToggle.checked=false;
  const v=localStorage.getItem('musicVol'); if(v) vol.value=v;
  applyMusicToggle();
})();

/* ---- SFX (beeps) ---- */
let audioCtx=null;function ensureAC(){if(!audioCtx){const AC=window.AudioContext||window.webkitAudioContext;audioCtx=new AC();}}
function playCorrect(){if(!document.getElementById('sfxToggle').checked)return;ensureAC();const t=audioCtx.currentTime,o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type='sine';o.frequency.setValueAtTime(660,t);o.frequency.exponentialRampToValueAtTime(990,t+.18);g.gain.setValueAtTime(.0001,t);g.gain.exponentialRampToValueAtTime(.25,t+.02);g.gain.exponentialRampToValueAtTime(.0001,t+.22);o.connect(g).connect(audioCtx.destination);o.start(t);o.stop(t+.24)}
function playEnc(){if(!document.getElementById('sfxToggle').checked)return;ensureAC();const t=audioCtx.currentTime,o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type='sine';o.frequency.setValueAtTime(300,t);o.frequency.exponentialRampToValueAtTime(240,t+.22);g.gain.setValueAtTime(.0001,t);g.gain.exponentialRampToValueAtTime(.18,t+.02);g.gain.exponentialRampToValueAtTime(.0001,t+.26);o.connect(g).connect(audioCtx.destination);o.start(t);o.stop(t+.28)}
/* victory sound */
function playVictory(){if(!document.getElementById('sfxToggle').checked)return;ensureAC();const t=audioCtx.currentTime,o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type='triangle';o.frequency.setValueAtTime(523.25,t);o.frequency.exponentialRampToValueAtTime(1046.5,t+.6);g.gain.setValueAtTime(.0001,t);g.gain.exponentialRampToValueAtTime(.35,t+.05);g.gain.exponentialRampToValueAtTime(.0001,t+.75);o.connect(g).connect(audioCtx.destination);o.start(t);o.stop(t+.8)}

/* ---- Quiz data ---- */
const QUIZ=[
  {q:"Which is the smallest planet in our Solar System?",choices:["Mercury","Mars","Venus","Pluto"],correct:0,explain:"Correct! Mercury is the smallest of the eight major planets.",artQ:"mercuryQ",artA:"mercuryA"},
  {q:"Which planet is known as the Red Planet?",choices:["Jupiter","Mars","Saturn","Neptune"],correct:1,explain:"Correct! Mars looks red because of iron oxide dust.",artQ:"marsQ",artA:"marsA"},
  {q:"What is the name of the galaxy we live in?",choices:["Andromeda","Sombrero","Milky Way","Triangulum"],correct:2,explain:"Correct! We live in the spiral Milky Way galaxy.",artQ:"galQ",artA:"galA"},
  {q:"What force keeps planets in orbit around the Sun?",choices:["Magnetism","Friction","Gravity","Electricity"],correct:2,explain:"Correct! Gravity is the attractive force between masses.",artQ:"gravQ",artA:"gravA"},
  {q:"Who was the first human to walk on the Moon?",choices:["Buzz Aldrin","Neil Armstrong","Yuri Gagarin","Alan Shepard"],correct:1,explain:"Correct! Neil Armstrong stepped onto the lunar surface on July 20, 1969.",artQ:"moonQ",artA:"moonA"},
  {q:"Which planet has the most striking ring system?",choices:["Saturn","Uranus","Jupiter","Neptune"],correct:0,explain:"Correct! Saturnâ€™s rings are the most prominent.",artQ:"saturnQ",artA:"saturnA"},
  {q:"Which planet orbits the Sun in about 88 Earth days?",choices:["Mercury","Earth","Venus","Mars"],correct:0,explain:"Correct! Mercuryâ€™s short orbital period is ~88 Earth days.",artQ:"mercuryQ",artA:"mercuryA"},
  {q:"What kind of star is the Sun?",choices:["Neutron star","Red giant","Yellow dwarf (G-type)","White dwarf"],correct:2,explain:"Correct! The Sun is a Gâ€‘type mainâ€‘sequence star.",artQ:"sunQ",artA:"sunA"},
  {q:"What is the supermassive black hole at the center of the Milky Way called?",choices:["Cygnus Xâ€‘1","Sagittarius A*","V404 Cygni","Betelgeuse"],correct:1,explain:"Correct! Sagittarius A* lies at the galaxyâ€™s core.",artQ:"bhQ",artA:"bhA"},
  {q:"What is the Kuiper Belt?",choices:["Asteroid belt between Mars and Jupiter","A region beyond Neptune filled with icy bodies and dwarf planets","A field of comets that surrounds the Sun at great distances (the Oort Cloud)","Another name for Saturn's rings"],correct:1,explain:"Correct! The Kuiper Belt lies beyond Neptune and hosts many icy objects, including Pluto.",artQ:"kbQ",artA:"kbA"}
];

/* ---- DOM refs ---- */
const qtext=document.getElementById('qtext');
const answersEl=document.getElementById('answers');
const nextBtn=document.getElementById('nextBtn');
const resetBtn=document.getElementById('resetBtn');
const statusEl=document.getElementById('status');
const hero=document.getElementById('hero');
const answerTitle=document.getElementById('answerTitle');
const answerInfo=document.getElementById('answerInfo');
const qart=document.getElementById('qart');
document.getElementById('qtotal').textContent=QUIZ.length;

/* ---- Hero/Q art (SVG generators; answer art ~50% larger) ---- */
const svg = {
  mercuryQ:()=>`<svg viewBox="0 0 300 220"><circle cx="160" cy="110" r="60" fill="#b9c0cc"/></svg>`,
  mercuryA:()=>`<svg viewBox="0 0 600 400"><circle cx="320" cy="200" r="140" fill="#b9c0cc"/></svg>`,
  marsQ:   ()=>`<svg viewBox="0 0 300 220"><circle cx="160" cy="110" r="60" fill="#d14b4b"/></svg>`,
  marsA:   ()=>`<svg viewBox="0 0 600 400"><circle cx="320" cy="200" r="140" fill="#d14b4b"/></svg>`,
  galQ:    ()=>`<svg viewBox="0 0 300 220"><g transform="translate(180,110)"><ellipse rx="90" ry="22" fill="none" stroke="#7bd3ff" stroke-width="3"/><ellipse rx="65" ry="18" fill="none" stroke="#a78bfa" stroke-width="3"/><circle r="12" fill="#ffd27a"/></g></svg>`,
  galA:    ()=>`<svg viewBox="0 0 600 400"><g transform="translate(360,200)"><ellipse rx="260" ry="70" fill="none" stroke="#7bd3ff" stroke-width="6"/><ellipse rx="180" ry="50" fill="none" stroke="#a78bfa" stroke-width="6"/><circle r="40" fill="#ffd27a"/></g></svg>`,
  gravQ:   ()=>`<svg viewBox="0 0 300 220"><circle cx="150" cy="110" r="12" fill="#ffd27a"/><circle cx="230" cy="110" r="8" fill="#7bd3ff"/><path d="M230 110 A80 40 0 1 1 70 110" fill="none" stroke="#7bd3ff"/></svg>`,
  gravA:   ()=>`<svg viewBox="0 0 600 400"><circle cx="300" cy="200" r="24" fill="#ffd27a"/><circle cx="470" cy="200" r="16" fill="#7bd3ff"/><ellipse cx="300" cy="200" rx="260" ry="80" fill="none" stroke="#7bd3ff" stroke-width="6"/></svg>`,
  moonQ:   ()=>`<svg viewBox="0 0 300 220"><circle cx="200" cy="90" r="40" fill="#e5edf7"/></svg>`,
  moonA:   ()=>`<svg viewBox="0 0 600 400"><circle cx="420" cy="160" r="120" fill="#e5edf7"/></svg>`,
  saturnQ: ()=>`<svg viewBox="0 0 300 220"><circle cx="160" cy="110" r="44" fill="#d6b36a"/><ellipse cx="160" cy="110" rx="90" ry="24" fill="none" stroke="#c6b28a" stroke-width="6" opacity=".65"/></svg>`,
  saturnA: ()=>`<svg viewBox="0 0 600 400"><circle cx="320" cy="200" r="110" fill="#d6b36a"/><ellipse cx="320" cy="200" rx="260" ry="70" fill="none" stroke="#c6b28a" stroke-width="12" opacity=".65"/></svg>`,
  sunQ:    ()=>`<svg viewBox="0 0 300 220"><circle cx="160" cy="110" r="60" fill="#f59e0b"/></svg>`,
  sunA:    ()=>`<svg viewBox="0 0 600 400"><circle cx="320" cy="200" r="160" fill="#f59e0b"/></svg>`,
  bhQ:     ()=>`<svg viewBox="0 0 300 220"><g transform="translate(190,110)"><circle r="16" fill="#000"/><ellipse rx="90" ry="28" fill="none" stroke="#7c3aed" stroke-width="4"/></g></svg>`,
  bhA:     ()=>`<svg viewBox="0 0 600 400"><g transform="translate(360,200)"><circle r="60" fill="#000"/><ellipse rx="280" ry="100" fill="none" stroke="#7c3aed" stroke-width="10" opacity=".7"/><ellipse rx="360" ry="130" fill="none" stroke="#a78bfa" stroke-width="8" opacity=".5"/></g></svg>`,
  kbQ:     ()=>`<svg viewBox="0 0 300 220"><g fill="#bfe7ff"><circle cx="100" cy="110" r="6"/><circle cx="140" cy="80" r="5"/><circle cx="180" cy="140" r="6"/></g></svg>`,
  kbA:     ()=>`<svg viewBox="0 0 600 400"><g fill="#bfe7ff" opacity=".9"><circle cx="220" cy="200" r="10"/><circle cx="300" cy="140" r="8"/><circle cx="380" cy="220" r="9"/><circle cx="460" cy="160" r="7"/><circle cx="520" cy="240" r="10"/></g></svg>`
};

/* ---- Helpers ---- */
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}
function fadeInSVG(container,svgStr){
  container.innerHTML=svgStr;
  const el=container.querySelector('svg'); requestAnimationFrame(()=>el.classList.add('show'));
}

let order=shuffle([...Array(QUIZ.length).keys()]), idx=0, score=0, answered=new Array(QUIZ.length).fill(null);
let llUsed={fifty:false,hint:false,skip:false};

function updateHeader(){document.getElementById('qnum').textContent=Math.min(idx+1,QUIZ.length)}
function renderQuestion(){
  const q=QUIZ[order[idx]];
  // reset lifeline UI (usage persists)
  document.getElementById('ll5050').disabled=llUsed.fifty;
  document.getElementById('llHint').disabled=llUsed.hint;
  document.getElementById('llSkip').disabled=llUsed.skip;

  qtext.textContent=q.q;
  setThumb('neutral');
  // question art (smaller)
  qart.innerHTML=svg[q.artQ]();
  // answers
  answersEl.innerHTML='';
  q.choices.forEach((t,i)=>{
    const li=document.createElement('li');
    li.className='answer';
    li.innerHTML=`<span class="dot"></span><span class="label">${t}</span>`;
    li.addEventListener('click',()=>selectAnswer(i,li,q));
    answersEl.appendChild(li);
  });
  // clear right panel
  answerTitle.textContent='';
  answerInfo.textContent='';
  hero.innerHTML='';
  nextBtn.disabled=true;
  statusEl.textContent='Select an answer to continue.';
  updateHeader();
}

function selectAnswer(i,li,q){
  const qi=order[idx];
  const prev=answered[qi]; answered[qi]=i;

  document.querySelectorAll('.answer').forEach(el=>el.classList.remove('selected','correct','incorrect'));
  li.classList.add('selected');

  // show correct/incorrect styling
  const arr=[...document.querySelectorAll('.answer')];
  arr[q.correct].classList.add('correct');
  if(i!==q.correct) li.classList.add('incorrect');

  // scoring adjustments if user changes choice
  if(prev===null){ if(i===q.correct) score+=1; }
  else{
    if(prev===q.correct && i!==q.correct) score-=1;
    if(prev!==q.correct && i===q.correct) score+=1;
  }

  // right panel content (title + info centered) and distinct art
  answerTitle.textContent = q.choices[q.correct];
  answerInfo.textContent = q.explain;
  fadeInSVG(hero, svg[q.artA]());

  // SFX + avatar
  if(i===q.correct){ setThumb('happy'); playCorrect(); }
  else { setThumb('encourage'); playEnc(); }

  statusEl.textContent = (i===q.correct) ? "Great job!" : "Give it another look.";
  nextBtn.disabled=false;
}

function next(){
  if(idx<QUIZ.length-1){ idx+=1; renderQuestion(); }
  else{ renderScore(); }
}

function reset(){
  score=0; answered=new Array(QUIZ.length).fill(null); order=shuffle([...Array(QUIZ.length).keys()]); idx=0;
  llUsed={fifty:false,hint:false,skip:false};
  nextBtn.disabled=true; renderQuestion();
}

function renderScore(){
  setThumb('happy');
  playVictory();
  // show video overlay
  const overlay=document.getElementById('winOverlay');
  const vid=document.getElementById('winVid');
  overlay.style.display='grid';
  music.pause(); // let video own the audio channel
  vid.currentTime=0; vid.play().catch(()=>{});
  vid.onended=()=>{ overlay.style.display='none'; applyMusicToggle(); reset(); };
  document.getElementById('closeWin').onclick=()=>{ vid.pause(); overlay.style.display='none'; applyMusicToggle(); reset(); };
}

/* ---- Lifelines (single-use) ---- */
document.getElementById('ll5050').addEventListener('click',()=>{
  if(llUsed.fifty) return; llUsed.fifty=true; document.getElementById('ll5050').disabled=true;
  const q=QUIZ[order[idx]]; const wrong=[0,1,2,3].filter(x=>x!==q.correct);
  shuffle(wrong).slice(0,2).forEach(w=>{
    const li=answersEl.children[w]; li.style.opacity=.35; li.style.pointerEvents='none';
  });
});
document.getElementById('llHint').addEventListener('click',()=>{
  if(llUsed.hint) return; llUsed.hint=true; document.getElementById('llHint').disabled=true;
  const q=QUIZ[order[idx]];
  statusEl.textContent='Hint: '+(
    q===QUIZ[order[idx]] && q.q.includes('smallest') ? 'Think closest to the Sun.' :
    q.q.includes('Red Planet') ? 'Dust makes the color.' :
    q.q.includes('galaxy') ? 'Spiral arms, lots of stars.' :
    q.q.includes('force') ? 'It keeps your feet on the ground.' :
    'Consider what you already know!'
  );
});
document.getElementById('llSkip').addEventListener('click',()=>{
  if(llUsed.skip) return; llUsed.skip=true; document.getElementById('llSkip').disabled=true;
  next();
});

/* ---- Wire up ---- */
document.getElementById('nextBtn').addEventListener('click',next);
document.getElementById('resetBtn').addEventListener('click',reset);

/* ---- Init ---- */
(function init(){
  loadAvatar(AVATAR_FILES.neutral,src=>thumb.src=src);
  document.getElementById('qtotal').textContent=QUIZ.length;
  renderQuestion();
  // try to start music right away (some browsers require gesture; checkbox is pre-checked)
  applyMusicToggle();
})();
</script>
</body>
</html>

